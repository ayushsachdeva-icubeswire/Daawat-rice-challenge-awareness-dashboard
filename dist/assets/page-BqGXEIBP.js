import{h as f,r as l,j as e,F as P}from"./index-82rsXWI8.js";import{C as y}from"./ComponentContainerCard-DwfAb1Cn.js";import{P as C}from"./PageTitle-COGIQQZz.js";import{C as w}from"./challengerService-BqN-eKAo.js";import{A as p}from"./api-ClkYFUjX.js";import"./Card-CaoJgQf4.js";import"./IconifyIcon-C8gGJes7.js";const I=()=>{var j;const{showNotification:h}=f(),[x,g]=l.useState(!1),[c,u]=l.useState([]),[o,N]=l.useState(""),[r,n]=l.useState({page:1,limit:10}),[t,v]=l.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10});l.useEffect(()=>{const a=setTimeout(async()=>{try{g(!0);const m={...r,search:o},i=await w.getAllChallengers(m);u(i.data||[]),v({currentPage:i.currentPage||1,totalPages:i.totalPages||1,totalItems:i.totalItems||0,itemsPerPage:r.limit||10})}catch(m){console.error("❌ Error fetching challengers:",m),h({message:"Error fetching challengers",variant:"danger"}),u([])}finally{g(!1)}},300);return()=>clearTimeout(a)},[r.page,r.limit,r.category,r.subcategory,r.type,r.duration,o,h]);const d=s=>{n(a=>({...a,page:s}))},b=s=>{try{if(s.startsWith("http://")||s.startsWith("https://")){window.open(s,"_blank","noopener,noreferrer");return}let a=s;s.startsWith("/")?a=`${p.BASE_URL}/${s}`:a=`${p.BASE_URL}/${s}`,window.open(a,"_blank","noopener,noreferrer")}catch(a){console.error("Error opening PDF:",a),alert(`Error opening PDF: ${a instanceof Error?a.message:"Unknown error"}`)}};return e.jsxs(e.Fragment,{children:[e.jsx(C,{subName:"Daawat",title:"Challengers"}),e.jsxs(y,{id:"challengers-list",title:"All Challengers",description:"Manage and view all registered challengers",children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:e.jsx("i",{className:"fas fa-search"})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search challengers...",value:o,onChange:s=>N(s.target.value)})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:r.category||"",onChange:s=>n(a=>({...a,category:s.target.value||void 0})),children:[e.jsx("option",{value:"",disabled:!0,children:"All Categories"}),e.jsx("option",{value:"Vegetarian",children:"Vegetarian"}),e.jsx("option",{value:"veg-egg",children:"Veg + Egg"}),e.jsx("option",{value:"veg-meat",children:"Veg + Meat"})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:r.duration||"",onChange:s=>n(a=>({...a,duration:s.target.value||void 0})),children:[e.jsx("option",{value:"",disabled:!0,children:"All Durations"}),e.jsx("option",{value:"7 days",children:"7 days"}),e.jsx("option",{value:"14 days",children:"14 days"}),e.jsx("option",{value:"21 days",children:"21 days"}),e.jsx("option",{value:"30 days",children:"30 days"})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:((j=r.limit)==null?void 0:j.toString())||"10",onChange:s=>n(a=>({...a,limit:parseInt(s.target.value),page:1})),children:[e.jsx("option",{value:"5",children:"5 per page"}),e.jsx("option",{value:"10",children:"10 per page"}),e.jsx("option",{value:"25",children:"25 per page"}),e.jsx("option",{value:"50",children:"50 per page"})]})})]}),x?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"spinner-border",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading challengers..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name & Contact"}),e.jsx("th",{children:"Category "}),e.jsx("th",{children:"Duration"}),e.jsx("th",{children:"Subcategory"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"PDF"})]})}),e.jsx("tbody",{children:c.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"text-center py-4",children:[e.jsx("i",{className:"fas fa-users fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No challengers found"}),e.jsx("p",{className:"text-muted",children:"Try adjusting your search or filter criteria."})]})}):c.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"avatar-md me-2",children:e.jsx("div",{className:"avatar-title bg-primary-subtle text-primary rounded-circle",children:s.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h6",{className:"mb-0",children:s.name}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-phone me-1"}),e.jsx("a",{href:`tel:${s.mobile}`,className:"text-decoration-none",children:s.mobile})]})]})]})}),e.jsx("td",{children:e.jsxs("div",{children:[e.jsx("span",{className:`badge ${s.category==="Vegetarian"?"bg-success":s.category==="Keto"?"bg-warning":"bg-info"} mb-1`,children:s.category}),e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:s.type})]})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-secondary",children:s.duration})}),e.jsx("td",{children:e.jsx("span",{className:"text-muted",children:s.subcategory||"N/A"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.isActive?"bg-success":"bg-secondary"}`,children:s.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsx("span",{className:"text-muted",children:s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A"})}),e.jsx("td",{children:s.pdf?e.jsxs("button",{className:"btn btn-sm btn-outline-success",onClick:()=>b(s.pdf),title:"View PDF",children:[e.jsx("i",{className:"fas fa-file-pdf me-1"}),"View"]}):e.jsx("span",{className:"text-muted",children:"No PDF"})})]},s._id))})]})}),t.totalPages>1&&e.jsx("nav",{"aria-label":"Challengers pagination",children:e.jsxs("ul",{className:"pagination justify-content-center",children:[e.jsx("li",{className:`page-item ${t.currentPage===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>d(t.currentPage-1),disabled:t.currentPage===1,children:"Previous"})}),Array.from({length:t.totalPages},(s,a)=>a+1).map(s=>e.jsx("li",{className:`page-item ${t.currentPage===s?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>d(s),children:s})},s)),e.jsx("li",{className:`page-item ${t.currentPage===t.totalPages?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>d(t.currentPage+1),disabled:t.currentPage===t.totalPages,children:"Next"})})]})}),!x&&c.length>0&&e.jsx("div",{className:"row mt-3",children:e.jsx("div",{className:"col-md-6",children:e.jsxs("small",{className:"text-muted",children:["Showing ",(t.currentPage-1)*t.itemsPerPage+1," to"," ",Math.min(t.currentPage*t.itemsPerPage,t.totalItems)," of"," ",t.totalItems," challengers"]})})})]}),e.jsx(P,{})]})};export{I as default};
