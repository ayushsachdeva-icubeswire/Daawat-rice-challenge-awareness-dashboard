import{h as b,r as l,j as e,F as f}from"./index-QfV4rlQB.js";import{C as y}from"./ComponentContainerCard-Bxhh8ezo.js";import{P as C}from"./PageTitle-DEYYPHnZ.js";import{C as w}from"./challengerService-Dx5Z3LhA.js";import{A as p}from"./api-ClkYFUjX.js";import"./Card-DPjYn8v6.js";import"./IconifyIcon-DyVxtpEY.js";const I=()=>{var j;const{showNotification:h}=b(),[g,x]=l.useState(!1),[o,u]=l.useState([]),[d,N]=l.useState(""),[r,i]=l.useState({page:1,limit:10}),[a,v]=l.useState({currentPage:1,totalPages:1,totalItems:0,itemsPerPage:10});l.useEffect(()=>{const t=setTimeout(async()=>{try{x(!0);const m={...r,search:d},c=await w.getAllChallengers(m);u(c.data||[]),v({currentPage:c.currentPage||1,totalPages:c.totalPages||1,totalItems:c.totalItems||0,itemsPerPage:r.limit||10})}catch(m){console.error("❌ Error fetching challengers:",m),h({message:"Error fetching challengers",variant:"danger"}),u([])}finally{x(!1)}},300);return()=>clearTimeout(t)},[r.page,r.limit,r.category,r.subcategory,r.type,r.duration,d,h]);const n=s=>{i(t=>({...t,page:s}))},P=s=>{try{if(s.startsWith("http://")||s.startsWith("https://")){window.open(s,"_blank","noopener,noreferrer");return}let t=s;s.startsWith("/")?t=`${p.BASE_URL}/${s}`:t=`${p.BASE_URL}/${s}`,window.open(t,"_blank","noopener,noreferrer")}catch(t){console.error("Error opening PDF:",t),alert(`Error opening PDF: ${t instanceof Error?t.message:"Unknown error"}`)}};return e.jsxs(e.Fragment,{children:[e.jsx(C,{subName:"Daawat",title:"Challengers"}),e.jsxs(y,{id:"challengers-list",title:"All Challengers",description:"Manage and view all registered challengers",children:[e.jsxs("div",{className:"row mb-4",children:[e.jsx("div",{className:"col-md-4",children:e.jsxs("div",{className:"input-group",children:[e.jsx("span",{className:"input-group-text",children:e.jsx("i",{className:"fas fa-search"})}),e.jsx("input",{type:"text",className:"form-control",placeholder:"Search challengers...",value:d,onChange:s=>N(s.target.value)})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:r.category||"",onChange:s=>i(t=>({...t,category:s.target.value||void 0})),children:[e.jsx("option",{value:"",disabled:!0,children:"All Categories"}),e.jsx("option",{value:"Vegetarian",children:"Vegetarian"}),e.jsx("option",{value:"Veg + Egg",children:"Veg + Egg"}),e.jsx("option",{value:"Veg + Meat",children:"Veg + Meat"})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:r.duration||"",onChange:s=>i(t=>({...t,duration:s.target.value||void 0})),children:[e.jsx("option",{value:"",disabled:!0,children:"All Durations"}),e.jsx("option",{value:"7 days",children:"7 days"}),e.jsx("option",{value:"14 days",children:"14 days"}),e.jsx("option",{value:"21 days",children:"21 days"}),e.jsx("option",{value:"30 days",children:"30 days"})]})}),e.jsx("div",{className:"col-md-2",children:e.jsxs("select",{className:"form-select",value:((j=r.limit)==null?void 0:j.toString())||"10",onChange:s=>i(t=>({...t,limit:parseInt(s.target.value),page:1})),children:[e.jsx("option",{value:"5",children:"5 per page"}),e.jsx("option",{value:"10",children:"10 per page"}),e.jsx("option",{value:"25",children:"25 per page"}),e.jsx("option",{value:"50",children:"50 per page"})]})})]}),g?e.jsxs("div",{className:"text-center py-4",children:[e.jsx("div",{className:"spinner-border",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading challengers..."})]}):e.jsx("div",{className:"table-responsive",children:e.jsxs("table",{className:"table table-hover",children:[e.jsx("thead",{className:"table-light",children:e.jsxs("tr",{children:[e.jsx("th",{children:"Name & Contact"}),e.jsx("th",{children:"Category "}),e.jsx("th",{children:"Duration"}),e.jsx("th",{children:"Subcategory"}),e.jsx("th",{children:"Status"}),e.jsx("th",{children:"Created"}),e.jsx("th",{children:"PDF"})]})}),e.jsx("tbody",{children:o.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"text-center py-4",children:[e.jsx("i",{className:"fas fa-users fa-3x text-muted mb-3"}),e.jsx("h5",{className:"text-muted",children:"No challengers found"}),e.jsx("p",{className:"text-muted",children:"Try adjusting your search or filter criteria."})]})}):o.map(s=>e.jsxs("tr",{children:[e.jsx("td",{children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("div",{className:"avatar-md me-2",children:e.jsx("div",{className:"avatar-title bg-primary-subtle text-primary rounded-circle",children:s.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("h6",{className:"mb-0",children:s.name}),e.jsxs("small",{className:"text-muted",children:[e.jsx("i",{className:"fas fa-phone me-1"}),e.jsx("a",{href:`tel:${s.mobile}`,className:"text-decoration-none",children:s.mobile})]})]})]})}),e.jsx("td",{children:e.jsxs("div",{children:[e.jsx("span",{className:`badge ${s.category==="Vegetarian"?"bg-success":s.category==="Keto"?"bg-warning":"bg-info"} mb-1`,children:s.category}),e.jsx("br",{}),e.jsx("small",{className:"text-muted",children:s.type})]})}),e.jsx("td",{children:e.jsx("span",{className:"badge bg-secondary",children:s.duration})}),e.jsx("td",{children:e.jsx("span",{className:"text-muted",children:s.subcategory||"N/A"})}),e.jsx("td",{children:e.jsx("span",{className:`badge ${s.isActive?"bg-success":"bg-secondary"}`,children:s.isActive?"Active":"Inactive"})}),e.jsx("td",{children:e.jsx("span",{className:"text-muted",children:s.createdAt?new Date(s.createdAt).toLocaleDateString():"N/A"})}),e.jsx("td",{children:s.pdf?e.jsxs("button",{className:"btn btn-sm btn-outline-success",onClick:()=>P(s.pdf),title:"View PDF",children:[e.jsx("i",{className:"fas fa-file-pdf me-1"}),"View"]}):e.jsx("span",{className:"text-muted",children:"No PDF"})})]},s._id))})]})}),a.totalPages>1&&e.jsx("nav",{"aria-label":"Challengers pagination",children:e.jsxs("ul",{className:"pagination justify-content-center",children:[e.jsx("li",{className:`page-item ${a.currentPage===1?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>n(a.currentPage-1),disabled:a.currentPage===1,children:"Previous"})}),a.currentPage>3&&e.jsxs(e.Fragment,{children:[e.jsx("li",{className:"page-item",children:e.jsx("button",{className:"page-link",onClick:()=>n(1),children:"1"})}),a.currentPage>4&&e.jsx("li",{className:"page-item disabled",children:e.jsx("span",{className:"page-link",children:"..."})})]}),Array.from({length:a.totalPages},(s,t)=>t+1).filter(s=>s===a.currentPage||s===a.currentPage-2||s===a.currentPage-1||s===a.currentPage+1||s===a.currentPage+2).map(s=>e.jsx("li",{className:`page-item ${a.currentPage===s?"active":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>n(s),children:s})},s)),a.currentPage<a.totalPages-2&&e.jsxs(e.Fragment,{children:[a.currentPage<a.totalPages-3&&e.jsx("li",{className:"page-item disabled",children:e.jsx("span",{className:"page-link",children:"..."})}),e.jsx("li",{className:"page-item",children:e.jsx("button",{className:"page-link",onClick:()=>n(a.totalPages),children:a.totalPages})})]}),e.jsx("li",{className:`page-item ${a.currentPage===a.totalPages?"disabled":""}`,children:e.jsx("button",{className:"page-link",onClick:()=>n(a.currentPage+1),disabled:a.currentPage===a.totalPages,children:"Next"})})]})}),!g&&o.length>0&&e.jsx("div",{className:"row mt-3",children:e.jsx("div",{className:"col-md-6",children:e.jsxs("small",{className:"text-muted",children:["Showing ",(a.currentPage-1)*a.itemsPerPage+1," to"," ",Math.min(a.currentPage*a.itemsPerPage,a.totalItems)," of"," ",a.totalItems," challengers"]})})})]}),e.jsx(f,{})]})};export{I as default};
