var ae=Object.defineProperty;var se=(s,t,a)=>t in s?ae(s,t,{enumerable:!0,configurable:!0,writable:!0,value:a}):s[t]=a;var y=(s,t,a)=>se(s,typeof t!="symbol"?t+"":t,a);import{j as e,R as z,d as D,l as T,r as f,F as ne}from"./index-i1U1nOjU.js";import{I as N}from"./IconifyIcon-Br_KgnN3.js";import{C as F,a as H,b as O}from"./Card-6HjfSkS2.js";import{B as P}from"./Badge-CvgqqxHU.js";import{S as q}from"./Spinner-BU7-rhDm.js";import{B as I}from"./ListGroup-DPem_Y07.js";import{f as L}from"./numberFormat-yIx-nKgv.js";import{R as ee}from"./react-apexcharts.min-C8DAkitb.js";import{S as re}from"./Spinner-0kkcpPia.js";import{P as ie}from"./PageTitle-BvPu2Dzq.js";import{A as te}from"./api-ClkYFUjX.js";import{C as B}from"./campaignContentsService-C-3q-UIb.js";import{C as oe}from"./challengerService-DmbA4ccT.js";import"./warning-CXwIM_aZ.js";import"./hook-D1juTmHu.js";import"./extends-CF3RwP-h.js";import"./Nav-C0jdXf-S.js";import"./DataKey-COGXBUcQ.js";import"./NavContext-CAeA-e2u.js";import"./useMergedRefs-D_Zc7cK5.js";import"./useEventCallback-BNUQOHgM.js";import"./Button-CIVqCDvY.js";const le=s=>{const t=new Date(s),n=Math.floor((new Date().getTime()-t.getTime())/1e3);if(n<60)return"just now";if(n<3600){const r=Math.floor(n/60);return`${r} ${r===1?"minute":"minutes"} ago`}else if(n<86400){const r=Math.floor(n/3600);return`${r} ${r===1?"hour":"hours"} ago`}else{const r=Math.floor(n/86400);return`${r} ${r===1?"day":"days"} ago`}},ce=({challengers:s,title:t="Recent Challengers",showHeader:a=!0,maxHeight:n="400px",isLoading:r=!1,error:m=null,onTitleClick:o})=>{const h=c=>{switch(c.toLowerCase()){case"weight loss":return"#ef4444";case"muscle building":return"#10b981";case"endurance":return"#f59e0b";case"flexibility":return"#8b5cf6";default:return"#6b7280"}},g=c=>{switch(c.toLowerCase()){case"weight loss":return"danger";case"muscle building":return"success";case"endurance":return"warning";case"flexibility":return"info";default:return"secondary"}},i=c=>c?"solar:check-circle-broken":"solar:pause-circle-broken",p=c=>c?"success":"secondary";return e.jsxs(F,{className:"h-100",children:[a&&e.jsxs(H,{className:"d-flex align-items-center justify-content-between",children:[e.jsx("h5",{className:`card-title mb-0 ${o?"text-primary cursor-pointer":""}`,onClick:o,style:o?{cursor:"pointer"}:{},children:t}),e.jsx(P,{bg:"primary",pill:!0,children:s.length})]}),e.jsx(O,{className:"p-0",children:e.jsx("div",{style:{maxHeight:n,overflowY:"auto"},children:r?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(q,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2 text-muted",children:"Loading challengers..."})]}):m?e.jsxs("div",{className:"text-center py-4 text-danger",children:[e.jsx(N,{icon:"solar:danger-circle-broken",className:"fs-48 mb-2"}),e.jsx("p",{children:m})]}):e.jsx(I,{variant:"flush",children:s.length===0?e.jsxs(I.Item,{className:"text-center py-4 text-muted",children:[e.jsx(N,{icon:"solar:users-group-two-rounded-broken",className:"fs-48 mb-2"}),e.jsx("p",{children:"No challengers available"})]}):s.map(c=>{var w;return e.jsx(I.Item,{className:"px-3 py-3",children:e.jsxs(z,{className:"align-items-start",children:[e.jsx(D,{xs:"auto",children:e.jsx("div",{className:"avatar-sm rounded-circle d-flex align-items-center justify-content-center",style:{backgroundColor:`${h(c.type)}20`,fontWeight:600,fontSize:"1.1rem",color:h(c.type)},children:(w=c.name)==null?void 0:w.charAt(0).toUpperCase()})}),e.jsxs(D,{children:[e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsx("h6",{className:"mb-0 text-truncate flex-grow-1 me-2",children:c.name}),e.jsxs(P,{bg:p(c.isActive),className:"d-flex align-items-center",children:[e.jsx(N,{icon:i(c.isActive),className:"fs-12 me-1"}),c.isActive?"Active":"Inactive"]})]}),e.jsxs("p",{className:"text-muted mb-2 small",children:[e.jsx(N,{icon:"solar:phone-broken",className:"fs-12 me-1"}),c.mobile]}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(P,{bg:g(c.type),className:"me-2",children:c.type}),e.jsx("span",{className:"text-muted small",children:c.category})]}),e.jsx("div",{className:"text-end",children:e.jsxs("div",{className:"text-primary fw-semibold small",children:[e.jsx(N,{icon:"solar:clock-circle-broken",className:"fs-12 me-1"}),c.duration]})})]}),c.subcategory&&e.jsx("div",{className:"mb-2",children:e.jsx(P,{bg:"light",text:"dark",className:"small",children:c.subcategory})}),c.createdAt&&e.jsxs("div",{className:"d-flex align-items-center text-muted small",children:[e.jsx(N,{icon:"solar:calendar-broken",className:"fs-12 me-1"}),"Created ",le(c.createdAt)]})]})]})},c._id)})})})})]})},de=({posts:s,title:t="Recent Posts",showHeader:a=!0,maxHeight:n="400px",isLoading:r=!1,error:m=null,onTitleClick:o})=>{const h=i=>{if(!i)return"";const p=typeof i=="string"?parseInt(i):Number(i);if(isNaN(p)||p<=0)return"";const c=new Date(p*1e3),k=Math.floor((new Date().getTime()-c.getTime())/1e3);if(k<60)return"just now";if(k<3600){const j=Math.floor(k/60);return`${j} ${j===1?"minute":"minutes"} ago`}else if(k<86400){const j=Math.floor(k/3600);return`${j} ${j===1?"hour":"hours"} ago`}else{const j=Math.floor(k/86400);return`${j} ${j===1?"day":"days"} ago`}},g=i=>{const p=`https://www.instagram.com/${i}/#`;window.open(p,"_blank")};return e.jsxs(F,{className:"h-100",children:[a&&e.jsxs(H,{className:`d-flex align-items-center justify-content-between ${o?"user-select-none":""}`,style:{cursor:o?"pointer":"default",transition:o?"background-color 0.2s":"none"},onClick:o,title:o?"Click to open hashtag performance in new tab":"",onMouseEnter:i=>{o&&(i.currentTarget.style.backgroundColor="#f8f9fa")},onMouseLeave:i=>{o&&(i.currentTarget.style.backgroundColor="")},children:[e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx("h5",{className:"card-title mb-0 me-2",children:t}),o&&e.jsx(N,{icon:"solar:external-link-broken",className:"fs-12 text-muted"})]}),e.jsx(P,{bg:"primary",pill:!0,children:s.length})]}),e.jsx(O,{className:"p-0",children:e.jsx("div",{style:{maxHeight:n,overflowY:"auto"},children:e.jsx(I,{variant:"flush",children:r?e.jsxs(I.Item,{className:"text-center py-4 text-muted",children:[e.jsx("div",{className:"spinner-border text-primary",role:"status",children:e.jsx("span",{className:"visually-hidden",children:"Loading..."})}),e.jsx("p",{className:"mt-2",children:"Loading campaign posts..."})]}):m?e.jsxs(I.Item,{className:"text-center py-4 text-muted",children:[e.jsx(N,{icon:"solar:danger-circle-broken",className:"fs-48 mb-2 text-danger"}),e.jsx("p",{className:"text-danger",children:m})]}):s.length===0?e.jsxs(I.Item,{className:"text-center py-4 text-muted",children:[e.jsx(N,{icon:"solar:document-text-broken",className:"fs-48 mb-2"}),e.jsx("p",{children:"No campaign posts available"})]}):s.map(i=>{var p,c,w,k,j,S;return e.jsx(I.Item,{className:"px-3 py-3",children:e.jsxs(z,{className:"align-items-start",children:[e.jsx(D,{xs:"auto",children:e.jsxs("div",{className:"rounded-circle overflow-hidden position-relative",style:{width:"40px",height:"40px",minWidth:"40px",minHeight:"40px"},children:[e.jsx("img",{src:((p=i.influencer)==null?void 0:p.profile_pic_url)||"/images/users/user-1.jpg",alt:i.influencer.full_name,style:{width:"100%",height:"100%",objectFit:"cover",display:"block"},onError:x=>{const d=x.target;d.style.display="none";const M=d.nextElementSibling;M&&(M.style.display="flex")}}),e.jsx("div",{style:{width:"100%",height:"100%",display:"none",alignItems:"center",justifyContent:"center",backgroundColor:"#f8f9fa",position:"absolute",top:"0",left:"0"},children:e.jsx(N,{icon:"solar:user-broken",className:"fs-18 text-muted"})})]})}),e.jsxs(D,{children:[e.jsxs("div",{className:"d-flex align-items-start justify-content-between mb-2",children:[e.jsxs("div",{className:"flex-grow-1 me-2",children:[e.jsx("h6",{className:"mb-1 text-truncate",children:e.jsxs("span",{className:"text-primary",style:{cursor:"pointer",textDecoration:"none"},onClick:()=>{var x,d;return g(((x=i.influencer)==null?void 0:x.handle)||((d=i.influencer)==null?void 0:d.username)||"")},onMouseEnter:x=>{x.currentTarget.style.textDecoration="underline"},onMouseLeave:x=>{x.currentTarget.style.textDecoration="none"},title:`Open @${((c=i.influencer)==null?void 0:c.handle)||((w=i.influencer)==null?void 0:w.username)||""} on Instagram`,children:["@",String(((k=i.influencer)==null?void 0:k.handle)||((j=i.influencer)==null?void 0:j.username)||"Unknown")]})}),e.jsx("div",{className:"d-flex align-items-center text-muted small mb-1",children:e.jsx("span",{className:"me-2",children:String(((S=i.influencer)==null?void 0:S.full_name)||"")})})]}),e.jsx("div",{className:"text-end",children:e.jsxs("div",{className:"badge bg-success-subtle text-success small",children:[String(L(Number(i.total_followers)||0))," followers"]})})]}),e.jsx("p",{className:"text-muted mb-2 small",children:(()=>{let x="";if(i.caption){const d=i.caption;typeof d=="object"&&d[0]&&d[0].text?x=String(d[0].text):typeof d=="string"&&(x=d)}return x&&x.length>150&&(x=x.substring(0,150)+"..."),x||"No caption available"})()}),e.jsxs("div",{className:"d-flex align-items-center justify-content-between mb-2",children:[e.jsxs("div",{className:"d-flex align-items-center",children:[Array.isArray(i.hashtags)&&i.hashtags.slice(0,2).map((x,d)=>e.jsx(P,{bg:"light",text:"dark",className:"me-1 small",children:String(x||"")},d)),Array.isArray(i.hashtags)&&i.hashtags.length>2&&e.jsxs("span",{className:"text-muted small",children:["+",i.hashtags.length-2," more"]})]}),e.jsx("small",{className:"text-muted",children:String(h(i.created_timestamp)||"")})]}),e.jsx("div",{className:"d-flex align-items-center justify-content-between",children:e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx(N,{icon:"solar:heart-broken",className:"fs-12 me-1 text-danger"}),e.jsx("span",{className:"small text-muted",children:String(L(Number(i.total_likes)||0))})]}),e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx(N,{icon:"solar:chat-round-line-broken",className:"fs-12 me-1 text-primary"}),e.jsx("span",{className:"small text-muted",children:String(L(Number(i.total_comments)||0))})]}),e.jsxs("div",{className:"d-flex align-items-center me-3",children:[e.jsx(N,{icon:"solar:share-broken",className:"fs-12 me-1 text-success"}),e.jsx("span",{className:"small text-muted",children:String(L(Number(i.reshare_count)||0))})]}),e.jsxs("div",{className:"d-flex align-items-center",children:[e.jsx(N,{icon:"solar:eye-broken",className:"fs-12 me-1 text-muted"}),e.jsx("span",{className:"small text-muted",children:String(L(Number(i.reach)||0))})]})]})})]})]})},i._id)})})})})]})},ue=({challengrsGraphData:s,isLoading:t=!1,error:a=null})=>{const r=(()=>{if(!s||s.length===0)return{categories:["No Data"],completedData:[0],inProgressData:[0]};const o=s.map(i=>new Date(i.date).toLocaleDateString("en-US",{month:"short",day:"numeric"})),h=s.map(i=>i.Completed),g=s.map(i=>i.InProgress);return{categories:o,completedData:h,inProgressData:g}})(),m={chart:{type:"bar",height:350,toolbar:{show:!1}},series:[{name:"Completed",data:r.completedData,color:"#10b981"},{name:"In Progress",data:r.inProgressData,color:"#3b82f6"}],xaxis:{categories:r.categories,labels:{style:{colors:"#8e8da4"}}},yaxis:{labels:{style:{colors:"#8e8da4"}}},grid:{borderColor:"#f1f3fa"},plotOptions:{bar:{horizontal:!1,columnWidth:"60%",borderRadius:4}},dataLabels:{enabled:!1},legend:{position:"top",horizontalAlign:"right"},tooltip:{theme:"light"}};return e.jsxs(F,{children:[e.jsx(H,{children:e.jsx("h5",{className:"card-title mb-0",children:"Challenges Progress"})}),e.jsx(O,{children:t?e.jsxs("div",{className:"text-center py-4",children:[e.jsx(q,{animation:"border",variant:"primary"}),e.jsx("p",{className:"mt-2 text-muted",children:"Loading chart data..."})]}):a?e.jsxs("div",{className:"text-center py-4 text-danger",children:[e.jsx(N,{icon:"solar:danger-circle-broken",className:"fs-48 mb-2"}),e.jsx("p",{children:a})]}):e.jsx(ee,{options:m,series:m.series,type:"bar",height:350})})]})},me=({postGraphData:s=[],isLoading:t=!1,error:a=null})=>{const r=(()=>{if(Array.isArray(s)&&s.length>0){const o=s.map(h=>({timestamp:h.x,date:new Date(h.x).toLocaleDateString("en-US",{month:"short",day:"numeric"}),value:h.y})).sort((h,g)=>h.timestamp-g.timestamp);return{categories:o.map(h=>h.date),publishedData:o.map(h=>h.value),timestamps:o.map(h=>h.timestamp)}}return{categories:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],publishedData:[5,8,12,15,18,22,25,28,32,35,38,42],timestamps:[]}})(),m={chart:{type:"area",height:350,toolbar:{show:!1}},series:[{name:"Posts Count",data:r.publishedData,color:"#f59e0b"}],xaxis:{categories:r.categories,labels:{style:{colors:"#8e8da4"}}},yaxis:{labels:{style:{colors:"#8e8da4"}}},grid:{borderColor:"#f1f3fa"},stroke:{curve:"smooth",width:2},fill:{type:"gradient",gradient:{shadeIntensity:1,opacityFrom:.7,opacityTo:.3,stops:[0,90,100]}},dataLabels:{enabled:!1},legend:{position:"top",horizontalAlign:"right"},tooltip:{theme:"light"}};return e.jsxs(F,{children:[e.jsx(H,{children:e.jsx("div",{className:"d-flex justify-content-between align-items-center",children:e.jsx("h5",{className:"card-title mb-0",children:"Post Analytics"})})}),e.jsx(O,{children:t?e.jsx("div",{className:"d-flex justify-content-center align-items-center",style:{height:"350px"},children:e.jsx(re,{})}):a?e.jsx("div",{className:"d-flex justify-content-center align-items-center text-danger",style:{height:"350px"},children:e.jsxs("div",{className:"text-center",children:[e.jsx("i",{className:"mdi mdi-alert-circle-outline fs-2 mb-2"}),e.jsx("p",{className:"mb-0",children:a})]})}):e.jsx(ee,{options:m,series:m.series,type:"area",height:350})})]})},Q=s=>{var t,a,n;try{const r=(t=T.getCookie("_DARKONE_AUTH_KEY_"))==null?void 0:t.toString();if(r){const o=JSON.parse(r);if(o!=null&&o.token)return o.token}const m=(a=T.getCookie("token"))==null?void 0:a.toString();return s||m||localStorage.getItem("authToken")||""}catch(r){console.warn("Failed to get auth token from session:",r);const m=(n=T.getCookie("token"))==null?void 0:n.toString();return s||m||localStorage.getItem("authToken")||""}},$=class ${constructor(){y(this,"fallbackToken","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4ZThkMjQxYzkyMWE5ZDEzMzhmNGMwMyIsImlhdCI6MTc2MDU5NDU5MiwiZXhwIjoxNzYwNjgwOTkyfQ.9ttWBQlQj6pDY-9mJp4gwGdvHbFJlGzWciWAnHPxzls")}static getInstance(){return $.instance||($.instance=new $),$.instance}async getChallengerProgress(){try{const t=Q(this.fallbackToken);if(!t)return console.warn("Authentication token not found, using mock data."),this.getMockProgressData();const a=await fetch(`${te.API_URL}/challenger/progress`,{method:"GET",headers:{authorization:t,"Content-Type":"application/json"}});if(!a.ok){const r=await a.json().catch(()=>({message:"Failed to fetch progress data"}));if(a.status===401||r.message==="Unauthorized!")return console.warn("Using mock data due to authentication failure. Please check your token."),this.getMockProgressData();throw new Error(r.message||`HTTP ${a.status}: Failed to fetch progress data`)}return await a.json()}catch(t){if(console.error("Progress API Error:",t),t.name==="TypeError"&&t.message.includes("fetch"))return console.warn("Network error detected, using mock data."),this.getMockProgressData();throw new Error(t.message||"Failed to fetch progress data")}}getMockProgressData(){return{data:{erProgress:{_id:"68f09870df697dec080d18fa",name:"engagement",currentValue:483408,previousValue:483398,manualEntries:10,difference:10,createdAt:"2025-10-16T07:02:08.496Z",updatedAt:"2025-10-16T07:02:08.496Z",__v:0},challengerProgress:{_id:"68f0c1e2f4275b75860cbf9e",name:"challenge",currentValue:3,previousValue:2,manualEntries:0,difference:1,createdAt:"2025-10-16T09:58:58.000Z",updatedAt:"2025-10-16T09:58:58.000Z",__v:0}}}}setAuthToken(t){this.fallbackToken=t}getAuthToken(){return Q(this.fallbackToken)}};y($,"instance");let J=$;const he=J.getInstance();class ge{constructor(t){y(this,"el");y(this,"piece");y(this,"top");y(this,"bottom");y(this,"back");y(this,"backBottom");y(this,"currentValue");const a=document.createElement("span");a.className="flip-clock__wrapper1";const n=document.createElement("span");n.className="flip-clock__piece m-0",n.innerHTML='<b class="flip-clock__card card1"><b class="card__top"></b><b class="card__bottom"></b><b class="card__back"><b class="card__bottom"></b></b></b>',a.appendChild(n),this.el=a,this.piece=n,this.top=n.querySelector(".card__top"),this.bottom=n.querySelector(".card__bottom"),this.back=n.querySelector(".card__back"),this.backBottom=n.querySelector(".card__back .card__bottom"),this.currentValue="",this.update(t)}update(t,a=!1){const n=t.toString(),r=n!==this.currentValue;(r||a)&&(this.back.setAttribute("data-value",this.currentValue),this.bottom.setAttribute("data-value",this.currentValue),this.currentValue=n,this.top.textContent=n,this.backBottom.setAttribute("data-value",n),(r||a)&&(this.el.classList.remove("flip"),this.el.offsetWidth,this.el.classList.add("flip")))}updateInstant(t){const a=t.toString();this.currentValue=a,this.top.textContent=a,this.back.setAttribute("data-value",a),this.bottom.setAttribute("data-value",a),this.backBottom.setAttribute("data-value",a)}}class fe{constructor(t,a=0){y(this,"container");y(this,"value");y(this,"digits");this.container=t,this.value=a,this.digits=[],this.render()}render(){this.container.innerHTML="";const t=this.value.toString();this.digits=[];for(let a=0;a<t.length;a++){const n=new ge(t[a]);this.container.appendChild(n.el),this.digits.push(n)}}update(){const t=this.value.toString();if(t.length>this.digits.length)this.render();else for(let a=0;a<this.digits.length;a++){const n=t.length-this.digits.length+a,r=n>=0?t[n]:"0";this.digits[a].update(r)}}setValue(t){this.value=t,this.update()}setValueWithAnimation(t,a){const n=t.toString(),r=a.toString(),m=Math.max(n.length,r.length),o=n.padStart(m,"0"),h=r.padStart(m,"0");if(n.length>this.digits.length){this.value=t,this.render();return}this.value=t;for(let g=0;g<this.digits.length;g++){const i=o.length-this.digits.length+g,p=i>=0?o[i]:"0",c=i>=0&&i<h.length?h[i]:"0";p!==c?this.digits[g].update(p,!0):this.digits[g].updateInstant(p)}}setValueInstant(t){const a=t.toString();if(a.length>this.digits.length){this.value=t,this.render();return}this.value=t;for(let n=0;n<this.digits.length;n++){const r=a.length-this.digits.length+n,m=r>=0?a[r]:"0";this.digits[n].updateInstant(m)}}}const K=({progressType:s,label:t,className:a="",animationDuration:n=5e3,pollInterval:r=1e4})=>{const m=f.useRef(null),o=f.useRef(null),h=f.useRef(null),g=f.useRef(null),[i,p]=f.useState(null),[c,w]=f.useState(!1),[k,j]=f.useState(0),S=f.useRef(0),x=f.useCallback(async()=>{try{console.log(`${s}: Calling API...`);const l=(await he.getChallengerProgress()).data[s];if(l)return console.log(`${s}: API response received:`,l),p(l),l;console.warn(`${s}: No data found in API response`)}catch(u){console.error(`${s}: Error fetching data:`,u)}return null},[s]),d=f.useRef(),M=f.useCallback(()=>{console.log(`${s}: Scheduling next API poll in ${r}ms`),g.current&&clearTimeout(g.current),g.current=setTimeout(async()=>{try{console.log(`${s}: Timer triggered - Fetching new progress data...`);const u=await x();if(u){if(console.log(`${s}: API returned data:`,{currentValue:u.currentValue,previousValue:u.previousValue,difference:u.difference,lastDisplayed:k}),c){console.log(`${s}: Still animating, rescheduling poll`),setTimeout(()=>{var v;return(v=d.current)==null?void 0:v.call(d)},2e3);return}const l=S.current,b=u.currentValue!==l;if(console.log(`${s}: hasNewData: ${b}, newCurrentValue: ${u.currentValue}, lastDisplayedValue: ${l}`),b){console.log(`${s}: NEW data detected, animating from ${l} to ${u.currentValue}`);const v=u.currentValue-l;p(u),E.current&&E.current(l,u.currentValue,v)}else console.log(`${s}: SAME data, no animation needed. Scheduling next poll`),setTimeout(()=>{d.current&&d.current()},100)}else console.warn(`${s}: Failed to fetch data, retrying in ${r}ms`),setTimeout(()=>{var l;return(l=d.current)==null?void 0:l.call(d)},r)}catch(u){console.error(`${s}: Error during API polling:`,u),setTimeout(()=>{var l;return(l=d.current)==null?void 0:l.call(d)},r)}},r)},[s,r,x]);d.current=M;const E=f.useRef(),_=f.useCallback((u,l,b)=>{if(console.log(`${s}: animateCounter called with fromValue: ${u}, toValue: ${l}, difference: ${b}`),u===l){console.log(`${s}: No animation needed (fromValue === toValue), setting value to: ${l}`),o.current&&o.current.setValueInstant(l),j(l),S.current=l,console.log(`${s}: Scheduling next poll after no-animation case`),setTimeout(()=>{console.log(`${s}: Executing scheduled poll from no-animation case`),d.current&&d.current()},100);return}w(!0);const v=Math.abs(b),V=Math.max(5,Math.min(v,50)),W=n/V,G=b/V;console.log(`${s}: Animation setup - absoluteDifference: ${v}, steps: ${V}, stepDuration: ${W}, stepValue: ${G}`);let R=0,C=u;h.current&&clearInterval(h.current),h.current=setInterval(()=>{R++;const Z=C;C=Math.round(u+G*R);const Y=b>0&&C>=l||b<0&&C<=l||R>=V;if(console.log(`${s}: Step ${R}/${V} - currentValue: ${C}, toValue: ${l}, reachedTarget: ${Y}`),Y){C=l,o.current&&o.current.setValueWithAnimation(C,Z),j(C),S.current=C,h.current&&(clearInterval(h.current),h.current=null),console.log(`${s}: Animation completed, reached value: ${C}`),setTimeout(()=>{w(!1),console.log(`${s}: States reset, scheduling next API poll after animation completion`),d.current&&d.current()},100);return}o.current&&o.current.setValueWithAnimation(C,Z)},W)},[n,s]);return E.current=_,f.useEffect(()=>m.current?((async()=>{const l=await x();if(l){console.log(`${s}: Initializing with data:`,l);const b=l.previousValue;j(b),S.current=b;const v=new fe(m.current,b);o.current=v,console.log(`${s}: Starting initial animation from ${l.previousValue} to ${l.currentValue}`),_(l.previousValue,l.currentValue,l.difference)}else console.warn(`${s}: No initial data received`),setTimeout(()=>{console.log(`${s}: No initial data, starting polling cycle`),d.current&&d.current()},1e3)})(),()=>{h.current&&clearInterval(h.current),g.current&&clearTimeout(g.current),m.current&&(m.current.innerHTML="")}):void 0,[]),e.jsxs("div",{className:`card h-100 border-0 ${a}`,style:{background:"linear-gradient(180deg, #ffffff 0%, #f7f7f7 100%)",border:"1px solid #e6e6e6",boxShadow:"0 1px 3px rgba(0, 0, 0, 0.05), inset 0 1px 0 rgba(255, 255, 255, 0.6)",position:"relative"},children:[e.jsx("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"2px",background:"linear-gradient(to right, #d4af37, transparent)",opacity:.5}}),e.jsxs("div",{className:"card-body d-flex flex-column justify-content-center align-items-center text-center p-4",children:[e.jsx("div",{className:"flip-counter-container w-100 mb-3",children:e.jsx("div",{className:"d-flex gap-2 justify-content-center",children:e.jsx("div",{ref:m,className:"flip-clock"})})}),e.jsx("div",{style:{width:"40%",height:"2px",background:"linear-gradient(to right, transparent, #c9a73b, transparent)",marginBottom:"12px"}}),e.jsxs("h6",{className:"card-title fw-semibold mb-0",style:{color:"#2e2e2e",fontSize:"0.95rem",textTransform:"uppercase",letterSpacing:"0.5px"},children:[t,c&&e.jsx("span",{className:"ms-2 text-primary",children:"ðŸ”„"})]}),e.jsx("div",{style:{width:"30%",height:"1px",backgroundColor:"#e0e0e0",marginTop:"10px"}}),i&&e.jsx("div",{className:"text-center mt-2",children:e.jsx("small",{className:"text-muted",style:{fontSize:"0.8rem",letterSpacing:"0.3px",opacity:.8},children:e.jsx("span",{className:`badge ${i.difference>0?"bg-success":i.difference<0?"bg-danger":"bg-secondary"}`})})})]}),e.jsx("div",{style:{position:"absolute",bottom:0,left:0,width:"100%",height:"3px",background:"linear-gradient(to right, transparent, #d4af37, transparent)",opacity:.3}})]})},X=s=>{var t,a,n;try{const r=(t=T.getCookie("_DARKONE_AUTH_KEY_"))==null?void 0:t.toString();if(r){const o=JSON.parse(r);if(o!=null&&o.token)return o.token}const m=(a=T.getCookie("token"))==null?void 0:a.toString();return s||m||localStorage.getItem("authToken")||""}catch(r){console.warn("Failed to get auth token from session:",r);const m=(n=T.getCookie("token"))==null?void 0:n.toString();return s||m||localStorage.getItem("authToken")||""}},A=class A{constructor(){y(this,"fallbackToken","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6IjY4ZThkMjQxYzkyMWE5ZDEzMzhmNGMwMyIsImlhdCI6MTc2MDQyMzkyMiwiZXhwIjoxNzYwNTEwMzIyfQ.jpyOCiQ_lunYouOyLSOXTWOJ3pDfWGg0JKxd9Rgparo")}static getInstance(){return A.instance||(A.instance=new A),A.instance}async getDashboardData(){try{const t=X(this.fallbackToken);if(!t)return console.warn("Authentication token not found, using mock data."),this.getMockDashboardData();const a=await fetch(`${te.API_URL}/dashboard`,{method:"GET",headers:{authorization:t,"Content-Type":"application/json"}});if(!a.ok){const r=await a.json().catch(()=>({message:"Failed to fetch dashboard data"}));if(a.status===401||r.message==="Unauthorized!")return console.warn("Using mock data due to authentication failure. Please check your token."),this.getMockDashboardData();throw new Error(r.message||`HTTP ${a.status}: Failed to fetch dashboard data`)}return await a.json()}catch(t){if(console.error("Dashboard API Error:",t),t.name==="TypeError"&&t.message.includes("fetch"))return console.warn("Network error detected, using mock data."),this.getMockDashboardData();throw new Error(t.message||"Failed to fetch dashboard data")}}getMockDashboardData(){return{totalStories:25,totalViews:15e3,totalLikes:12500,challengrsGraphData:[{date:"2025-10-13T00:00:00.000Z",Completed:0,InProgress:1},{date:"2025-10-16T00:00:00.000Z",Completed:0,InProgress:2}],postGraphData:{itchotels:[{x:170424e7,y:2},{x:17073504e5,y:3},{x:170856e7,y:4},{x:17099424e5,y:5},{x:17183232e5,y:3},{x:17241984e5,y:6},{x:17320608e5,y:4},{x:1737936e6,y:7},{x:17479584e5,y:5},{x:17555616e5,y:8},{x:17576352e5,y:6},{x:175824e7,y:9}],itchotels_count:25}}}setAuthToken(t){this.fallbackToken=t}getAuthToken(){return X(this.fallbackToken)}};y(A,"instance");let U=A;const xe=U.getInstance(),Fe=()=>{const[s,t]=f.useState([]),[a,n]=f.useState(!0),[r,m]=f.useState(null),[o]=f.useState("all"),h=[{value:"all",label:"All Hashtags",display:"All Hashtags"},{value:"onlydaawatnovember",label:"#onlydaawatnovember",display:"#onlydaawatnovember"},{value:"onlyricenovember",label:"#onlyricenovember",display:"#onlyricenovember"},{value:"riceyourawareness",label:"#riceyourawareness",display:"#riceyourawareness"}],[g,i]=f.useState(null),[p,c]=f.useState(!0),[w,k]=f.useState(null),[j,S]=f.useState([]),[x,d]=f.useState(!0),[M,E]=f.useState(null);return f.useEffect(()=>{(async()=>{try{c(!0),k(null);const u=await xe.getDashboardData();i(u)}catch(u){k("Failed to fetch dashboard data"),console.error("Error fetching dashboard data:",u)}finally{c(!1)}})()},[]),f.useEffect(()=>{(async()=>{try{n(!0);let u=o,l=[];o==="all"&&(l=h.filter(v=>v.value!=="all").map(v=>v.value));let b;o==="all"?b=await B.getMultipleHashtagsPerformance(l,1,10):b=await B.getCampaignContents(u,1,10),b.success&&b.data.posts?t(b.data.posts):t([])}catch(u){m("Failed to fetch campaign contents"),console.error("Error fetching campaign contents:",u),t([])}finally{n(!1)}})()},[o]),f.useEffect(()=>{(async()=>{try{d(!0),E(null);const u=await oe.getAllChallengers({limit:10,page:1});u.data&&S(u.data)}catch(u){E("Failed to fetch challengers"),console.error("Error fetching challengers:",u)}finally{d(!1)}})()},[]),e.jsxs(e.Fragment,{children:[e.jsx(ie,{subName:"Daawat",title:"Dashboard Analytics"}),e.jsxs(z,{className:"mb-4",children:[e.jsx(D,{xl:6,lg:6,md:12,children:e.jsx(K,{progressType:"challengerProgress",label:"Challenges Taken",className:"h-100",animationDuration:5e3,pollInterval:15e3})}),e.jsx(D,{xl:6,lg:6,md:12,children:e.jsx(K,{progressType:"erProgress",label:"Interactions",className:"h-100",animationDuration:5e3,pollInterval:15e3})})]}),e.jsx("div",{className:"mb-4"}),e.jsxs(z,{className:"mb-4 g-3",children:[e.jsx(D,{xl:6,lg:6,md:12,children:e.jsx(ue,{challengrsGraphData:(g==null?void 0:g.challengrsGraphData)||[],isLoading:p,error:w})}),e.jsx(D,{xl:6,lg:12,md:12,children:e.jsx(me,{postGraphData:Array.isArray(g==null?void 0:g.postGraphData)?g.postGraphData:[],isLoading:p,error:w})})]}),e.jsxs(z,{className:"mb-4 g-3",children:[e.jsx(D,{xl:6,lg:6,md:12,children:e.jsx(ce,{challengers:j,title:"Recent Challengers",showHeader:!0,maxHeight:"400px",isLoading:x,error:M,onTitleClick:()=>window.open("/challengers","_blank"),challengrsGraphData:(g==null?void 0:g.challengrsGraphData)||[]})}),e.jsx(D,{xl:6,lg:12,md:12,children:e.jsx(de,{posts:s,title:"Recent Posts",showHeader:!0,maxHeight:"400px",isLoading:a,error:r,onTitleClick:()=>window.open("/social/hashtag-performance","_blank")})})]}),e.jsx(ne,{})]})};export{Fe as default};
